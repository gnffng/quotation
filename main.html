<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>견적서 작성 프로그램</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h2>견적서 작성 프로그램</h2>

    <div class="info-panel">
        <div class="info-group">
            <label>수신자명 (업체명)</label>
            <input type="text" id="info_recipient" placeholder="예: OO건설 귀하">
        </div>
        <div class="info-group">
            <label>현장명</label>
            <input type="text" id="info_siteName" placeholder="현장명 입력">
        </div>
        <div class="info-group">
            <label>납품 기한</label>
            <input type="text" id="info_delivery" value="발주일로부터 50일">
        </div>
        <div class="info-group wide">
            <label>기타 특이사항 (하단 명시)</label>
            <textarea type="text" id="info_notes" placeholder="추가 사항 입력"></textarea>
        </div>
    </div>
    
    <div class="toolbar">
        <button class="btn btn-primary" onclick="openMainModal()">+ 견적품목 추가</button>
        <button class="btn btn-info" onclick="exportData()">견적서 내보내기 (JSON)</button>
        <button class="btn btn-warning" onclick="triggerImport()">견적서 불러오기 (JSON)</button>
        <button class="btn btn-secondary" onclick="printEstimate()">견적서 출력 (PDF)</button>
        <input type="file" id="importFile" style="display:none" onchange="importData(this)">
    </div>

    <table class="estimate-table" id="estimateTable">
        <thead>
            <tr>
                <th style="width: 15%;">품명</th>
                <th style="width: 12%;">규격</th>
                <th style="width: 10%;">재질</th>
                <th style="width: 6%;">수량</th>
                <th style="width: 12%;">단가 (자재합)</th>
                <th style="width: 12%;">금액</th>
                <th>비고</th>
                <th style="width: 10%;">관리</th>
            </tr>
        </thead>
        <tbody id="mainTbody">
            </tbody>
    </table>

    <div id="mainModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('mainModal')">&times;</span>
            <h3>견적품목 추가</h3>
            <div class="form-group"><label>품명</label><input type="text" id="m_name"></div>
            <div class="form-group"><label>규격</label><input type="text" id="m_spec"></div>
            <div class="form-group"><label>재질</label><input type="text" id="m_material"></div>
            <div class="form-group"><label>수량</label><input type="number" id="m_qty" value="1"></div>
            <div class="form-group"><label>비고</label><input type="text" id="m_note"></div>
            <button class="btn btn-primary" style="width:100%" onclick="addMainItem()">추가하기</button>
        </div>
    </div>

    <div id="subModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('subModal')">&times;</span>
            <h3>자재항목 추가</h3>
            <input type="hidden" id="currentMainId">
            
            <div class="form-group">
                <label>종류</label>
                <select id="s_kind" onchange="filterDetail()"><option value="">선택하세요</option></select>
            </div>
            <div class="form-group">
                <label>세부품명</label>
                <select id="s_detail" onchange="filterSpec()"><option value="">선택하세요</option></select>
            </div>
            <div class="form-group">
                <label>규격</label>
                <select id="s_spec" onchange="autoFillData()"><option value="">선택하세요</option></select>
            </div>
            
            <div id="dimension_area" style="display:none; background:#f0f8ff; padding:10px; margin-bottom:10px; border-radius:5px;">
                <div style="display:flex; gap:10px;">
                    <div style="flex:1">
                        <label style="font-size:12px;">가로</label>
                        <input type="number" id="s_width" step="0.001" onchange="calcDynamicPrice()" placeholder="값 입력">
                    </div>
                    <div style="flex:1">
                        <label style="font-size:12px;">세로</label>
                        <input type="number" id="s_height" step="0.001" onchange="calcDynamicPrice()" placeholder="값 입력">
                    </div>
                </div>
                <p style="font-size:11px; color:#007bff; margin:5px 0 0 0;">* 치수를 입력하면 단가가 자동 계산됩니다.</p>
            </div>

            <div class="form-group"><label>단위</label><input type="text" id="s_unit" readonly></div>
            <div class="form-group"><label>단가 (수정가능)</label><input type="number" id="s_price"></div>
            <div class="form-group">
                <label>공수 배율 (1.00 ~ 10.00)</label>
                <input type="number" id="s_multiplier" min="1.0" max="10.0" step="0.01" value="1.00">
            </div>
            <div class="form-group"><label>수량</label><input type="number" id="s_qty" value="1"></div>
            <div class="form-group"><label>비고</label><input type="text" id="s_note"></div>
            
            <button class="btn btn-primary" style="width:100%" onclick="addSubItem()">자재 추가하기</button>
        </div>
    </div>

    <div id="alertModal" class="modal">
        <div class="modal-content alert-content">
            <span class="close" onclick="closeModal('alertModal')">&times;</span>
            <h3>알림</h3>
            <div class="alert-msg" id="alertMsgText">메시지 내용</div>
            <button class="btn btn-danger" style="width:100%" onclick="closeModal('alertModal')">확인</button>
        </div>
    </div>

<script src="script.js"></script>

</body>
</html>